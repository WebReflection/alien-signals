var e;function i({update:e,notify:i,unwatched:t}){return{link:function(e,i){const t=i.depsTail;if(void 0!==t&&t.dep===e)return;let n;const s=4&i.flags;if(s&&(n=void 0!==t?t.nextDep:i.deps,void 0!==n&&n.dep===e))return void(i.depsTail=n);const u=e.subsTail;if(void 0!==u&&u.sub===i&&(!s||o(u,i)))return;const d=i.depsTail=e.subsTail={dep:e,sub:i,prevDep:t,nextDep:n,prevSub:u,nextSub:void 0};void 0!==n&&(n.prevDep=d);void 0!==t?t.nextDep=d:i.deps=d;void 0!==u?u.nextSub=d:e.subs=d},unlink:n,propagate:function(e){let t,n=e.nextSub;e:for(;;){const s=e.sub;let u=s.flags;if(3&u&&(60&u?12&u?4&u?48&u||!o(e,s)?u=0:(s.flags=40|u,u&=1):s.flags=-9&u|32:u=0:s.flags=32|u,2&u&&i(s),1&u)){const i=s.subs;if(void 0!==i){e=i,void 0!==i.nextSub&&(t={value:n,prev:t},n=e.nextSub);continue}}if(void 0===(e=n)){for(;void 0!==t;)if(e=t.value,t=t.prev,void 0!==e){n=e.nextSub;continue e}break}n=e.nextSub}},checkDirty:function(i,t){let n,o=0;e:for(;;){const u=i.dep,d=u.flags;let r=!1;if(16&t.flags)r=!0;else if(17&~d){if(!(33&~d)){void 0===i.nextSub&&void 0===i.prevSub||(n={value:i,prev:n}),i=u.deps,t=u,++o;continue}}else if(e(u)){const e=u.subs;void 0!==e.nextSub&&s(e),r=!0}if(r||void 0===i.nextDep){for(;o;){--o;const u=t.subs,d=void 0!==u.nextSub;if(d?(i=n.value,n=n.prev):i=u,r){if(e(t)){d&&s(u),t=i.sub;continue}}else t.flags&=-33;if(t=i.sub,void 0!==i.nextDep){i=i.nextDep;continue e}r=!1}return r}i=i.nextDep}},endTracking:function(e){const i=e.depsTail;let t=void 0!==i?i.nextDep:e.deps;for(;void 0!==t;)t=n(t,e);e.flags&=-5},startTracking:function(e){e.depsTail=void 0,e.flags=-57&e.flags|4},shallowPropagate:s};function n(e,i=e.sub){const n=e.dep,s=e.prevDep,o=e.nextDep,u=e.nextSub,d=e.prevSub;return void 0!==o?o.prevDep=s:i.depsTail=s,void 0!==s?s.nextDep=o:i.deps=o,void 0!==u?u.prevSub=d:n.subsTail=d,void 0!==d?d.nextSub=u:void 0===(n.subs=u)&&t(n),o}function s(e){do{const t=e.sub,n=e.nextSub,s=t.flags;32==(48&s)&&(t.flags=16|s,2&s&&i(t)),e=n}while(void 0!==e)}function o(e,i){const t=i.depsTail;if(void 0!==t){let n=i.deps;do{if(n===e)return!0;if(n===t)break;n=n.nextDep}while(void 0!==n)}return!1}}!function(e){e[e.None=0]="None",e[e.Mutable=1]="Mutable",e[e.Watching=2]="Watching",e[e.RecursedCheck=4]="RecursedCheck",e[e.Recursed=8]="Recursed",e[e.Dirty=16]="Dirty",e[e.Pending=32]="Pending"}(e||(e={}));const t=[],n=[],{link:s,unlink:o,propagate:u,checkDirty:d,endTracking:r,startTracking:l,shallowPropagate:f}=i({update:e=>"getter"in e?V(e):C(e,e.value),notify:function e(i){const t=i.flags;if(!(64&t)){i.flags=64|t;const s=i.subs;void 0!==s?e(s.sub):n[b++]=i}},unwatched(e){if("getter"in e){let i=e.deps;if(void 0!==i){e.flags=17;do{i=o(i,e)}while(void 0!==i)}}else"previousValue"in e||j.call(e)}});let a,v,c=0,p=0,b=0;function g(){return a}function h(e){const i=a;return a=e,i}function x(){return v}function T(e){const i=v;return v=e,i}function D(){++c}function S(){--c||N()}function y(){t.push(h(void 0))}function k(){h(t.pop())}function w(e){return O.bind({previousValue:e,value:e,subs:void 0,subsTail:void 0,flags:1})}function _(e){return W.bind({value:void 0,subs:void 0,subsTail:void 0,deps:void 0,depsTail:void 0,flags:17,getter:e})}function P(e){const i={fn:e,subs:void 0,subsTail:void 0,deps:void 0,depsTail:void 0,flags:2};void 0!==a?s(i,a):void 0!==v&&s(i,v);const t=h(i);try{i.fn()}finally{h(t)}return j.bind(i)}function R(e){const i={deps:void 0,depsTail:void 0,subs:void 0,subsTail:void 0,flags:0};void 0!==v&&s(i,v);const t=h(void 0),n=T(i);try{e()}finally{T(n),h(t)}return j.bind(i)}function V(e){const i=h(e);l(e);try{const i=e.value;return i!==(e.value=e.getter(i))}finally{h(i),r(e)}}function C(e,i){return e.flags=1,e.previousValue!==(e.previousValue=i)}function M(e,i){if(16&i||32&i&&d(e.deps,e)){const i=h(e);l(e);try{e.fn()}finally{h(i),r(e)}return}32&i&&(e.flags=-33&i);let t=e.deps;for(;void 0!==t;){const e=t.dep,i=e.flags;64&i&&M(e,e.flags=-65&i),t=t.nextDep}}function N(){for(;p<b;){const e=n[p];n[p++]=void 0,M(e,e.flags&=-65)}p=0,b=0}function W(){const e=this.flags;if(16&e||32&e&&d(this.deps,this)){if(V(this)){const e=this.subs;void 0!==e&&f(e)}}else 32&e&&(this.flags=-33&e);return void 0!==a?s(this,a):void 0!==v&&s(this,v),this.value}function O(...e){if(!e.length){const e=this.value;if(16&this.flags&&C(this,e)){const e=this.subs;void 0!==e&&f(e)}return void 0!==a&&s(this,a),e}{const i=e[0];if(this.value!==(this.value=i)){this.flags=17;const e=this.subs;void 0!==e&&(u(e),c||N())}}}function j(){let e=this.deps;for(;void 0!==e;)e=o(e,this);const i=this.subs;void 0!==i&&o(i),this.flags=0}const m=e=>new E(e),q=e=>new B(e),z=e=>{y();try{return e()}finally{k()}};class A{constructor(e,i){this._=e(i)}peek(){return z(this._)}valueOf(){return this.value}}class B extends A{constructor(e){super(w,e)}get value(){return this._()}set value(e){this._(e)}}class E extends A{constructor(e){super(_,e)}get value(){return this._()}}export{E as Computed,e as ReactiveFlags,A as Signal,B as State,c as batchDepth,m as computed,i as createReactiveSystem,P as effect,R as effectScope,S as endBatch,x as getCurrentScope,g as getCurrentSub,y as pauseTracking,k as resumeTracking,T as setCurrentScope,h as setCurrentSub,q as signal,D as startBatch,z as untracked};
